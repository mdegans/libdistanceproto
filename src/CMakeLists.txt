# Yeah, this is easier than Meson for sure for protobuf
INCLUDE(FindProtobuf)
FIND_PACKAGE(Protobuf REQUIRED)

INCLUDE_DIRECTORIES(${PROTOBUF_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})

PROTOBUF_GENERATE_CPP(PROTO_SRC PROTO_HEADER distance.proto)
PROTOBUF_GENERATE_PYTHON(PROTO_PY distance.proto)

ADD_LIBRARY(distanceproto ${PROTO_SRC})
SET_TARGET_PROPERTIES(distanceproto PROPERTIES PUBLIC_HEADER ${PROTO_HEADER})

INSTALL(
    TARGETS distanceproto
    DESTINATION lib
    PUBLIC_HEADER DESTINATION include
)
